(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{2:function(e,t,r){r("5b15df55c1316f23e9d0"),e.exports=r("baf7021f8a6fabdc859e")},"43a863c5e801a2996d08":function(e,t){e.exports="data:image/svg+xml,%3Csvg width='140px' height='28px' viewBox='0 0 140 28' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E %3C!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --%3E %3Cdesc%3ECreated with Sketch.%3C/desc%3E %3Cdefs%3E %3Cpolygon id='path-1' points='0 28 140 28 140 0 0 0'%3E%3C/polygon%3E %3C/defs%3E %3Cg id='Page-1' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E %3Cg id='\u9996\u9875' transform='translate(-618.000000, -157.000000)'%3E %3Cg id='Page-1' transform='translate(618.000000, 157.000000)'%3E %3Cpath d='M8,28 L0,28 L0,18.1672899 C0,13.6566901 3.58179046,10 8,10 L8,28 Z' id='Fill-1' fill='%23FFFFFF'%3E%3C/path%3E %3Cpath d='M31,28 L23,28 L23,18.2282813 C23,13.6839974 26.5817905,10 31,10 L31,10 L31,28 Z' id='Fill-3' fill='%23FFFFFF'%3E%3C/path%3E %3Cpath d='M80,28 L72,28 L72,18.2282813 C72,13.6839974 75.5817905,10 80,10 L80,28 Z' id='Fill-5' fill='%23FFFFFF'%3E%3C/path%3E %3Cmask id='mask-2' fill='white'%3E %3Cuse xlink:href='%23path-1'%3E%3C/use%3E %3C/mask%3E %3Cg id='Clip-8'%3E%3C/g%3E %3Cpolygon id='Fill-7' fill='%23FFFFFF' mask='url(%23mask-2)' points='33 28 41 28 41 10 33 10'%3E%3C/polygon%3E %3Cpath d='M93,28 L85,28 L85,18.2282813 C85,13.6839974 88.5817905,10 93,10 L93,10 L93,28 Z' id='Fill-9' fill='%23FFFFFF' mask='url(%23mask-2)'%3E%3C/path%3E %3Cpolygon id='Fill-10' fill='%23FFFFFF' mask='url(%23mask-2)' points='95 28 103 28 103 10 95 10'%3E%3C/polygon%3E %3Cpolygon id='Fill-11' fill='%23FFFFFF' mask='url(%23mask-2)' points='117 18 125 18 125 10 117 10'%3E%3C/polygon%3E %3Cpolygon id='Fill-12' fill='%23FFFFFF' mask='url(%23mask-2)' points='117 28 117 22 125 22 125 28'%3E%3C/polygon%3E %3Cpath d='M116,28 L108,28 L108,18.2282813 C108,13.6839974 111.58179,10 116,10 L116,10 L116,28 Z' id='Fill-13' fill='%23FFFFFF' mask='url(%23mask-2)'%3E%3C/path%3E %3Cpath d='M140,28 L132,28 L132,18.2282813 C132,13.6839974 135.58179,10 140,10 L140,10 L140,28 Z' id='Fill-14' fill='%23FFFFFF' mask='url(%23mask-2)'%3E%3C/path%3E %3Cpolygon id='Fill-15' fill='%23FFFFFF' mask='url(%23mask-2)' points='43 28 49 28 49 22 43 22'%3E%3C/polygon%3E %3Cpolygon id='Fill-16' fill='%23FFFFFF' mask='url(%23mask-2)' points='10 0 10 17.3490518 10 28 18 28 18 17.3490518 18 0'%3E%3C/polygon%3E %3Cpolyline id='Fill-17' fill='%23FFFFFF' mask='url(%23mask-2)' points='62.4719904 27.9633775 72.6822 3.20141258 139 3.20141258 139 0 65.8409953 0 65.8258196 0 65.8258196 0.0457780636 58.5900468 16.2411414 51.396766 0.182807067 51.396766 0 51.3360632 0 23 0 23 3.20141258 44.4978937 3.20141258 54.7214579 28 55.1481985 28 62.0318951 28 62.4598498 28'%3E%3C/polyline%3E %3Cpolygon id='Fill-18' fill='%23FFFFFF' mask='url(%23mask-2)' points='117 18 125 18 125 10 117 10'%3E%3C/polygon%3E %3Cpolygon id='Fill-19' fill='%23FFFFFF' mask='url(%23mask-2)' points='117 28 125 28 125 20 117 20'%3E%3C/polygon%3E %3C/g%3E %3C/g%3E %3C/g%3E %3C/svg%3E"},baf7021f8a6fabdc859e:function(e,t,r){"use strict";r.r(t);r("6ecf849f2614b19670b0");var n=r("acdf236fbd99e5336aa8"),a=r.n(n),o=(r("8c8e4f08a118a28666b0"),r("8af190b70a6bc55c6f1b")),i=r.n(o),c=r("235ef2b9b87705660668"),l=r("d7dd51e1bf6bfc2c9c3d"),s=r("657e23e47d6bc2372772"),u=r("3ad3c1378076e862aab0"),d=r("3e48a4ad164080264b3b"),f=r("0d7f0986bcd2f33d8a2a"),p=r.n(f),b=r("ab4cb61bcb2dc161defb"),g=r("811a4999285c4f950f0a"),m=r("fe25efaa8d6f45e3f5f9"),y="dq/App/LOGIN",h="dq/App/LOGGED",v="dq/App/LOGOUT",O=r("54f683fcda7806277002"),S=Object(O.fromJS)({logged:!1,loginUser:null});var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;switch(r){case h:return e.set("logged",!0).set("loginUser",n.user);case v:return e.set("logged",!1).set("loginUser",null);default:return e}},I=r("74431d47afb6248fcb69"),L=r("6c68d13fe9e3e77d8fc4");var E=r("95066b9b78a83cfbe91a"),F=r("55c69f0ea731e712b8f3"),C=r("9adba983ceae6f089ff0"),D=regeneratorRuntime.mark(j),A=regeneratorRuntime.mark(k);function j(e){var t,r,n,a,o,i;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,r=t.username,n=t.password,a=t.shareInfo,o=t.resolve,c.prev=1,c.next=4,Object(L.b)(E.a,{method:"post",url:"".concat(C.a.share,"/login/").concat(a),data:{username:r,password:n}});case 4:return i=c.sent,c.next=7,Object(L.c)((l=i.payload,{type:h,payload:{user:l}}));case 7:o(),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(1),Object(F.a)(c.t0);case 13:case"end":return c.stop()}var l},D,null,[[1,10]])}function k(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[Object(I.c)(y,j)];case 2:case"end":return e.stop()}},A)}var _=Object(g.a)({key:"global",reducer:w}),T=Object(m.a)({key:"global",saga:k}),R=Object(b.compose)(_,T)(function(e){return o.createElement("div",null,o.createElement(p.a,{titleTemplate:"%s - DQ",defaultTitle:"DQ Web Application",meta:[{name:"description",content:"DQ web application built for data visualization"}]}),o.Children.toArray(e.children))}),P=r("3c6f77ec51e7bc1a2a2a"),q=r("8f1ab66ca98a22c9179d"),x=r("13ca559d12796799b5b1"),N=r.n(x),H=r("4cad7676f6ad23a52c95"),V=(r("d23d02c7f068fee6a221"),r("1fa8f1fa59fdd9f24c28"),r("4ce54d943eb1f3decabb"),r("4e2e9348dad8fe460c1d")),U=r("64609e458c41f180e307");function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var M=Object(O.fromJS)({locationBeforeTransitions:null});function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.LOCATION_CHANGE:return e.merge({locationBeforeTransitions:t.payload});default:return e}}function Y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(V.combineReducers)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){W(e,t,r[t])})}return e}({route:z,language:U.a},e))}var B=Object(I.a)();var G=r("ed636e9c6a0f78dd7081"),J=(r("430efd9ee93fab5ea3aa"),r("ab77426700a64afb515f")),Q=r.n(J),K=(r("cce4e96b47a88eedc219"),r("4634762afad890a7174e")),Z=r.n(K),X=(r("aaa12c37f93504858944"),r("21677e23133eca295df8")),$=r.n(X),ee=r("a28fc3c963a1d4d1a2e5"),te="dq/Share/LOAD_SHARE_DASHBOARD",re="dq/Share/LOAD_SHARE_DASHBOARD_SUCCESS",ne="dq/Share/LOAD_SHARE_DASHBOARD_FAILURE",ae="dq/Share/SET_INDIVIDUAL_DASHBOARD",oe="dq/Share/LOAD_SHARE_WIDGET",ie="dq/Share/LOAD_SHARE_WIDGET_SUCCESS",ce="dq/Share/LOAD_SHARE_RESULTSET",le="dq/Share/LOAD_SHARE_RESULTSET_SUCCESS",se="dq/Share/LOAD_SHARE_RESULTSET_FAILURE",ue="dq/Share/LOAD_WIDGET_CSV",de="dq/Share/LOAD_WIDGET_CSV_SUCCESS",fe="dq/Share/LOAD_WIDGET_CSV_FAILURE",pe="dq/Share/LOAD_SELECT_OPTIONS",be="dq/Share/LOAD_SELECT_OPTIONS_SUCCESS",ge="dq/Share/LOAD_SELECT_OPTIONS_FAILURE",me="dq/Share/RESIZE_ALL_DASHBOARDITEM",ye="dq/Share/DRILL_DASHBOARDITEM",he="dq/Share/DELETE_DRILL_HISTORY",ve="dq/Share/SET_SELECT_OPTIONS",Oe="dq/Share/SELECT_DASHBOARD_ITEM_CHART",Se="dq/Share/GLOBAL_CONTROL_CHANGE",we="dq/Share/SEND_SHARE_PARAMS",Ie="dq/Share/LOAD_DOWNLOAD_LIST",Le="dq/Share/LOAD_DOWNLOAD_LIST_SUCCESS",Ee="dq/Share/LOAD_DOWNLOAD_LIST_FAILURE",Fe="dq/Share/DOWNLOAD_FILE",Ce="dq/Share/DOWNLOAD_FILE_SUCCESS",De="dq/Share/DOWNLOAD_FILE_FAILURE",Ae="dq/Share/INITIATE_DOWNLOAD_TASK",je="dq/Share/INITIATE_DOWNLOAD_TASK_SUCCESS",ke="dq/Share/INITIATE_DOWNLOAD_TASK_FAILURE",_e=r("e8016aecc1958cdf3c4a"),Te=r("11a323f8e5936c04fbd3"),Re=r("178f6adcf35ca45776ac"),Pe=r("9d7a9f8e28ee3216e3c6"),qe=r("f6c48cace3512f9906d5");function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){Ne(e,t,r[t])})}return e}function Ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function He(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ve=Object(O.fromJS)({dashboard:null,title:"",config:"{}",dashboardSelectOptions:null,widgets:null,items:null,itemsInfo:null,downloadListLoading:!1,downloadList:null,downloadListInfo:null,shareParams:null});var Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload,a=e.get("dashboardSelectOptions"),o=e.get("itemsInfo"),i=e.get("widgets"),c=e.get("downloadList"),l=e.get("shareParams");switch(r){case we:return e.set("shareParams",n.params);case re:var s=n.dashboard.config?JSON.parse(n.dashboard.config):{},u=(s.filters||[]).map(function(e){return Object(Re.b)(e)}).map(function(e){var t=e.relatedViews,r=e.name;return l&&Object.entries(t).forEach(function(t){var n=He(t,2),a=(n[0],n[1],l[r]);a&&a.length&&(e&&"date"===e.type&&(e.dynamicDefaultValue=_e.a.Custom),e.defaultValue=Array.isArray(a)&&a.length?a.map(function(e){return decodeURI(e)}):decodeURI(a))}),e}),d={};return u.forEach(function(e){var t=e.interactionType,r=e.relatedItems,n=e.relatedViews,a=Object(Te.a)(e);a&&Object.entries(r).forEach(function(r){var o=He(r,2),i=o[0],c=o[1];Object.entries(n).forEach(function(r){var n=He(r,2),o=n[0],l=n[1];if(c.checked&&c.viewId===Number(o)){var s="column"===t?Object(Te.h)(e,l,a):Object(Te.m)(e,l,a);d[i]||(d[i]={filters:[],variables:[]}),"column"===t?d[i].filters=d[i].filters.concat(s):d[i].variables=d[i].variables.concat(s)}})})}),e.set("title",n.dashboard.name).set("dashboard",xe({},n.dashboard,{config:JSON.stringify(xe({},s,{filters:u}))})).set("config",JSON.stringify(xe({},s,{filters:u}))).set("dashboardSelectOptions",{}).set("widgets",n.dashboard.widgets).set("items",n.dashboard.relations).set("itemsInfo",n.dashboard.relations.reduce(function(e,t){return e[t.id]={status:cr.Initial,datasource:{resultList:[]},loading:!1,queryConditions:{tempFilters:[],linkageFilters:[],globalFilters:d[t.id]?d[t.id].filters:[],variables:[],linkageVariables:[],globalVariables:d[t.id]?d[t.id].variables:[],pagination:{}},downloadCsvLoading:!1,interactId:"",renderType:"rerender",controlSelectOptions:{},errorMessage:""},e},{}));case ae:return e.set("items",[{id:1,x:0,y:0,width:12,height:12,polling:!1,frequency:0,widgetId:n.widgetId,dataToken:n.token}]).set("itemsInfo",{1:{status:cr.Initial,datasource:{resultList:[]},loading:!1,queryConditions:{tempFilters:[],linkageFilters:[],globalFilters:[],variables:[],linkageVariables:[],globalVariables:[],pagination:{}},downloadCsvLoading:!1,interactId:"",renderType:"rerender",controlSelectOptions:{},errorMessage:""}});case ie:return i||(i=[]),e.set("widgets",i.concat(n.widget));case Oe:return e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{renderType:n.renderType,selectedItems:n.selectedItems}))));case ce:return e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{selectedItems:[],loading:!0,errorMessage:"",queryConditions:xe({},o[n.itemId].queryConditions,{tempFilters:n.requestParams.tempFilters,linkageFilters:n.requestParams.linkageFilters,globalFilters:n.requestParams.globalFilters,variables:n.requestParams.variables,linkageVariables:n.requestParams.linkageVariables,globalVariables:n.requestParams.globalVariables,pagination:n.requestParams.pagination,nativeQuery:n.requestParams.nativeQuery})}))));case Se:var f=n.controlRequestParamsByItem;return Object.entries(f).forEach(function(e){var t=He(e,2),r=t[0],n=t[1],a=n.filters,i=n.variables;o[r].queryConditions=xe({},o[r].queryConditions,{},a&&{globalFilters:a},{},i&&{globalVariables:i})}),e.set("itemsInfo",o);case ye:return o[n.itemId].queryConditions.drillHistory||(o[n.itemId].queryConditions.drillHistory=[]),e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{queryConditions:xe({},o[n.itemId].queryConditions,{drillHistory:o[n.itemId].queryConditions.drillHistory.concat(n.drillHistory)})}))));case he:return e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{queryConditions:xe({},o[n.itemId].queryConditions,{drillHistory:o[n.itemId].queryConditions.drillHistory.slice(0,n.index+1)})}))));case le:return Object(qe.c)(n.resultset.resultList,n.requestParams.customOrders),e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{status:cr.Fulfilled,loading:!1,datasource:n.resultset||{resultList:[]},renderType:n.renderType}))));case se:return e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{status:cr.Error,loading:!1,errorMessage:n.errorMessage}))));case ue:return e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{downloadCsvLoading:!0}))));case de:case fe:return e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{downloadCsvLoading:!1}))));case be:return n.itemId?e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{controlSelectOptions:xe({},o[n.itemId].controlSelectOptions,Ne({},n.controlKey,n.values))})))):e.set("dashboardSelectOptions",xe({},a,Ne({},n.controlKey,n.values)));case ve:return n.itemId?e.set("itemsInfo",xe({},o,Ne({},n.itemId,xe({},o[n.itemId],{controlSelectOptions:xe({},o[n.itemId].controlSelectOptions,Ne({},n.controlKey,n.options))})))):e.set("dashboardSelectOptions",xe({},a,Ne({},n.controlKey,n.options)));case me:return e.set("itemsInfo",Object.entries(o).reduce(function(e,t){var r=He(t,2),n=r[0],a=r[1];return e[n]=xe({},a,{renderType:"resize",datasource:xe({},a.datasource)}),e},{}));case Ie:return e.set("downloadListLoading",!0);case Le:return e.set("downloadListLoading",!1).set("downloadList",n.list).set("downloadListInfo",n.list.reduce(function(e,t){return e[t.id]={loading:!1},e},{}));case Ee:return e.set("downloadListLoading",!1);case Ce:return e.set("downloadList",c.map(function(e){return e.id===n.id?xe({},e,{status:Pe.a.Downloaded}):e}));default:return e}},We=r("4633b5891e83a9df58b7"),Me=r.n(We);function ze(e){return{type:re,payload:{dashboard:e}}}function Ye(e){return{type:ie,payload:{widget:e}}}function Be(e,t,r,n){return{type:le,payload:{renderType:e,itemId:t,requestParams:r,resultset:n}}}function Ge(e,t){return{type:se,payload:{itemId:e,errorMessage:t}}}function Je(e){return{type:de,payload:{itemId:e}}}function Qe(e){return{type:fe,payload:{itemId:e}}}function Ke(e,t,r){return{type:be,payload:{controlKey:e,values:t,itemId:r}}}function Ze(e){return{type:Ce,payload:{id:e}}}function Xe(e,t){return{type:je,payload:{type:e,itemId:t}}}var $e=r("eb331aa378875c02c40d");function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){rt(e,t,r[t])})}return e}function rt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nt(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var at=regeneratorRuntime.mark(pt),ot=regeneratorRuntime.mark(bt),it=regeneratorRuntime.mark(gt),ct=regeneratorRuntime.mark(mt),lt=regeneratorRuntime.mark(yt),st=regeneratorRuntime.mark(ht),ut=regeneratorRuntime.mark(vt),dt=regeneratorRuntime.mark(Ot),ft=regeneratorRuntime.mark(St);$e.a[$e.b].shareHost;function pt(e){var t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,n.next=4,Object(L.b)(E.a,"".concat(C.a.share,"/dashboard/").concat(t.token));case 4:return r=n.sent,n.next=7,Object(L.c)(ze(r.payload));case 7:n.next=15;break;case 9:return n.prev=9,n.t0=n.catch(1),n.next=13,Object(L.c)({type:ne});case 13:Object(F.a)(n.t0),t.reject(n.t0);case 15:case"end":return n.stop()}},at,null,[[1,9]])}function bt(e){var t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,n.next=4,Object(L.b)(E.a,"".concat(C.a.share,"/widget/").concat(t.token));case 4:return r=n.sent,n.next=7,Object(L.c)(Ye(r.payload));case 7:t.resolve&&t.resolve(r.payload),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(1),Object(F.a)(n.t0),t.reject(n.t0);case 14:case"end":return n.stop()}},ot,null,[[1,10]])}function gt(e){var t,r,n,a,o,i,c,l,s,u,d,f,p,b,g,m,y,h,v;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return t=e.payload,r=t.renderType,n=t.itemId,a=t.dataToken,o=t.requestParams,i=o.filters,c=o.tempFilters,l=o.linkageFilters,s=o.globalFilters,u=o.variables,d=o.linkageVariables,f=o.globalVariables,p=o.pagination,b=nt(o,["filters","tempFilters","linkageFilters","globalFilters","variables","linkageVariables","globalVariables","pagination"]),m=(g=p||{pageSize:0,pageNo:0}).pageSize,y=g.pageNo,O.prev=4,O.next=7,Object(L.b)(E.a,{method:"post",url:"".concat(C.a.share,"/data/").concat(a),data:tt({},Me()(b,"customOrders"),{filters:i.concat(c).concat(l).concat(s),params:u.concat(d).concat(f),pageSize:m,pageNo:y})});case 7:return h=O.sent,v=h.payload.resultList,h.payload.resultList=v&&v.slice(0,600)||[],O.next=12,Object(L.c)(Be(r,n,o,h.payload));case 12:O.next=18;break;case 14:return O.prev=14,O.t0=O.catch(4),O.next=18,Object(L.c)(Ge(n,Object(F.b)(O.t0)));case 18:case"end":return O.stop()}},it,null,[[4,14]])}function mt(e){var t,r,n,a,o,i,c,l,s,u,d,f,p;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return t=e.payload,r=t.itemId,n=t.requestParams,a=t.token,o=n.filters,i=n.tempFilters,c=n.linkageFilters,l=n.globalFilters,s=n.variables,u=n.linkageVariables,d=n.globalVariables,f=nt(n,["filters","tempFilters","linkageFilters","globalFilters","variables","linkageVariables","globalVariables"]),b.prev=2,b.next=5,Object(L.b)(E.a,{method:"post",url:"".concat(C.a.share,"/csv/").concat(a),data:tt({},f,{filters:o.concat(i).concat(c).concat(l),params:s.concat(u).concat(d)})});case 5:return p=b.sent,b.next=8,Object(L.c)(Je(r));case 8:location.href=p.payload,b.next=16;break;case 11:return b.prev=11,b.t0=b.catch(2),b.next=15,Object(L.c)(Qe(r));case 15:Object(F.a)(b.t0);case 16:case"end":return b.stop()}},ct,null,[[2,11]])}function yt(e){var t,r,n,a,o,i,c,l,s;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,t=e.payload,r=t.controlKey,n=t.dataToken,a=t.requestParams,o=t.itemId,i=Object.entries(a),c=i.map(function(e){var t=et(e,2),r=t[0],a=t[1],o=a.columns,i=a.filters,c=a.variables,l=a.cache,s=a.expired;return Object(L.b)(E.a,{method:"post",url:"".concat(C.a.share,"/data/").concat(n,"/distinctvalue/").concat(r),data:{columns:o,filters:i,params:c,cache:l,expired:s}})}),u.next=7,Object(L.a)(c);case 7:return l=u.sent,s=l.reduce(function(e,t,r){var n=i[r][1].columns;return 1===n.length?e.concat(t.payload.map(function(e){return e[n[0]]})):e},[]),u.next=11,Object(L.c)(Ke(r,Array.from(new Set(s)),o));case 11:u.next=17;break;case 13:return u.prev=13,u.t0=u.catch(0),u.next=17,Object(L.c)((d=u.t0,{type:ge,payload:{error:d}}));case 17:case"end":return u.stop()}var d},lt,null,[[0,13]])}function ht(e){var t,r,n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,r=t.shareClinetId,n=t.token,o.prev=1,o.next=4,Object(L.b)(E.a,"".concat(C.a.download,"/share/page/").concat(r,"/").concat(n));case 4:return a=o.sent,o.next=7,Object(L.c)((c=a.payload,{type:Le,payload:{list:c}}));case 7:o.next=14;break;case 9:return o.prev=9,o.t0=o.catch(1),o.next=13,Object(L.c)((i=o.t0,{type:Ee,payload:{error:i}}));case 13:Object(F.a)(o.t0);case 14:case"end":return o.stop()}var i,c},st,null,[[1,9]])}function vt(e){var t,r,n,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,r=t.id,n=t.shareClinetId,a=t.token,o.prev=1,location.href="".concat(C.a.download,"/share/record/file/").concat(r,"/").concat(n,"/").concat(a),o.next=5,Object(L.c)(Ze(r));case 5:o.next=12;break;case 7:return o.prev=7,o.t0=o.catch(1),o.next=11,Object(L.c)((i=o.t0,{type:De,payload:{error:i}}));case 11:Object(F.a)(o.t0);case 12:case"end":return o.stop()}var i},ut,null,[[1,7]])}function Ot(e){var t,r,n,a,o,i;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,r=t.shareClientId,n=t.dataToken,a=t.type,o=t.itemId,c.prev=1,i=e.payload.downloadParams.map(function(e){var t=e.id,r=e.filters,n=e.tempFilters,a=e.linkageFilters,o=e.globalFilters,i=e.variables,c=e.linkageVariables,l=e.globalVariables;return{id:t,param:tt({},nt(e,["id","filters","tempFilters","linkageFilters","globalFilters","variables","linkageVariables","globalVariables"]),{filters:r.concat(n).concat(a).concat(o),params:i.concat(c).concat(l)})}}),c.next=5,Object(L.b)(E.a,{method:"POST",url:"".concat(C.a.download,"/share/submit/").concat(a,"/").concat(r,"/").concat(n),data:i});case 5:return $.a.success("\u4e0b\u8f7d\u4efb\u52a1\u521b\u5efa\u6210\u529f\uff01"),c.next=8,Object(L.c)(Xe(a,o));case 8:c.next=15;break;case 10:return c.prev=10,c.t0=c.catch(1),c.next=14,Object(L.c)((l=c.t0,{type:ke,payload:{error:l}}));case 14:Object(F.a)(c.t0);case 15:case"end":return c.stop()}var l},dt,null,[[1,10]])}function St(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[Object(I.c)(te,pt),Object(I.b)(oe,bt),Object(I.b)(ce,gt),Object(I.c)(ue,mt),Object(I.b)(pe,yt),Object(I.c)(Ie,ht),Object(I.c)(Fe,vt),Object(I.b)(Ae,Ot)];case 2:case"end":return e.stop()}},ft)}var wt=r("6c1890243ba884c62600"),It=r("38669f46145e5bedaa8f"),Lt=r("cd16e7d68404f3230c38"),Et=r("86d17dd26e83afa66ef9"),Ft=r("d13558d97f410e04ee44"),Ct=r("588010b67050044e2341"),Dt=r("30cc03302807d9f9cf5a"),At=r("b5d2e10ba1e6f6e55381"),jt=i.a.createElement("span",null),kt=i.a.createElement("input",{id:"headlessBrowserRenderSign",type:"hidden"});var _t=function(e){if(e.renderSign){var t=e.parentNode,r=t.offsetWidth,n=t.offsetHeight;return i.a.createElement(i.a.Fragment,null,kt,i.a.createElement("input",{id:"width",type:"hidden",value:r}),i.a.createElement("input",{id:"height",type:"hidden",value:n}))}return jt},Tt=r("dde802e9900958f55da9"),Rt=function(e){return e.get("shareDashboard")},Pt=r("e54a068d600ce8162b8c"),qt=r("545cc1d5b2c0ab4381ef"),xt=(r("c099c4fc48cd9bb84110"),r("21700e306353b2e19c0b")),Nt=r.n(xt),Ht=r("faa1775c23cdc998dbb4");function Vt(e){return(Vt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zt(e,t){return(zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Bt=r("f3ae47cf584ff0a4203b"),Gt=r("788b454b5eadc7b7f231"),Jt=o.createElement(p.a,{title:"Login"}),Qt=o.createElement(Nt.a,{type:"loading"}),Kt=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=Wt(t).call(this,e),r=!a||"object"!==Vt(a)&&"function"!==typeof a?Mt(n):a,Yt(Mt(r),"changeUsername",function(e){r.setState({username:e.target.value.trim()})}),Yt(Mt(r),"changePassword",function(e){r.setState({password:e.target.value})}),Yt(Mt(r),"doLogin",function(){var e=r.props,t=e.onLogin,n=e.shareInfo,a=e.legitimateUser,o=r.state,i=o.username,c=o.password;i&&c&&t(i,c,n,function(){a()})}),r.state={username:"",password:""},r}var n,a,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}(t,o["PureComponent"]),n=t,(a=[{key:"render",value:function(){var e=this.props.loginLoading,t=this.state,n=t.username,a=t.password;return o.createElement("div",{className:"".concat(Bt.container," ").concat(Bt.share)},Jt,o.createElement("img",{className:Bt.logo,src:r("43a863c5e801a2996d08")}),o.createElement("div",{className:"".concat(Bt.window," ").concat(Gt.window)},o.createElement(Ht.a,{username:n,password:a,onChangeUsername:this.changeUsername,onChangePassword:this.changePassword,onLogin:this.doLogin}),o.createElement("button",{disabled:e,onClick:this.doLogin},e?Qt:"","\u767b \u5f55")))}}])&&Ut(n.prototype,a),i&&Ut(n,i),t}();var Zt=Object(l.connect)(null,function(e){return{onLogin:function(t,r,n,a){return e(function(e,t,r,n){return{type:y,payload:{username:e,password:t,shareInfo:r,resolve:n}}}(t,r,n,a))}}})(Kt);function Xt(e){return(Xt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){ir(e,t,r[t])})}return e}function tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ar(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function or(e,t){return(or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var cr,lr=Tt.a.loadViewsDetail,sr=r("c7b06d3320a5509f12ff"),ur=Object(Ft.b)(Ft.a);!function(e){e[e.Initial=0]="Initial",e[e.Fulfilled=1]="Fulfilled",e[e.Error=2]="Error"}(cr||(cr={}));var dr=i.a.createElement("h3",null,"\u6570\u636e\u52a0\u8f7d\u4e2d\u2026\u2026"),fr=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=nr(t).call(this,e),r=!a||"object"!==Xt(a)&&"function"!==typeof a?ar(n):a,ir(ar(r),"interactCallbacks",{}),ir(ar(r),"interactingLinkagers",{}),ir(ar(r),"interactGlobalFilters",{}),ir(ar(r),"resizeSign",0),ir(ar(r),"shareClientId",function(){var e="";try{(e=localStorage.getItem("SHARE_CLIENT_ID"))||(e=Object(F.d)(32),localStorage.setItem("SHARE_CLIENT_ID",e))}catch(e){$.a.error("\u83b7\u53d6\u5206\u4eab\u9875\u5ba2\u6237\u7aefID\u5931\u8d25\uff1a".concat(e.message))}return e}()),ir(ar(r),"downloadListPollingTimer",void 0),ir(ar(r),"loadShareContent",function(e){var t=r.props,n=t.onLoadDashboard,a=t.onLoadWidget,o=t.onSetIndividualDashboard;"dashboard"===e.type?n(e.shareInfo,function(e){403===e.response.status&&r.setState({showLogin:!0})}):a(e.shareInfo,function(t){o(t.id,e.shareInfo)},function(e){403===e.response.status&&r.setState({showLogin:!0})})}),ir(ar(r),"querystring",function(e){return e.split("&").reduce(function(e,t){var n=tr(t.split("="),2),a=n[0],o=n[1];return o?(r.deep_set(e,a.split(/[\[\]]/g).filter(function(e){return e}),o),e):e},{})}),ir(ar(r),"getChartData",function(e,t,n,a){r.getData(r.props.onLoadResultset,e,t,n,a)}),ir(ar(r),"initPolling",function(e){r.props.onLoadDownloadList(r.shareClientId,e),r.downloadListPollingTimer=window.setInterval(function(){r.props.onLoadDownloadList(r.shareClientId,e)},qt.v)}),ir(ar(r),"initiateWidgetDownloadTask",function(e,t){var n=r.props.widgets.find(function(e){return e.id===t}),a={nativeQuery:!1};try{var o=JSON.parse(n.config),i=o.mode,c=o.selectedChart,l=o.chartStyles;"chart"===i&&c===Object(Pt.w)().id&&(a.nativeQuery=l.table.withNoAggregators)}catch(e){$.a.error(e)}r.getData(function(e,n,a,o){var i=[er({},o,{id:t})];r.props.onInitiateDownloadTask(r.shareClientId,a,Pe.b.Widget,i,n)},"rerender",e,t,a)}),ir(ar(r),"getData",function(e,t,n,a,o){var i,c,l,s,u,d,f,p,b,g,m=r.props,y=m.currentItemsInfo,h=m.widgets.find(function(e){return e.id===a}),v=JSON.parse(h.config),O=v.cols,S=v.rows,w=v.metrics,I=v.secondaryMetrics,L=v.filters,E=v.color,F=v.label,C=v.size,D=v.xAxis,A=v.tip,j=v.orders,k=v.cache,_=v.expired,T=O.map(function(e){return Object(Re.d)(e)}),R=S.map(function(e){return Object(Re.d)(e)}),P=T.concat(R).filter(function(e){var t=e.sort;return t&&t.sortType===qe.a.Custom}).map(function(e){return{name:e.name,list:e.sort[qe.a.Custom].sortList}}),q=y[n].queryConditions;o?(i=void 0!==o.tempFilters?o.tempFilters:q.tempFilters,c=void 0!==o.linkageFilters?o.linkageFilters:q.linkageFilters,l=void 0!==o.globalFilters?o.globalFilters:q.globalFilters,s=void 0!==o.orders?o.orders:q.orders,u=o.variables||q.variables,d=o.linkageVariables||q.linkageVariables,f=o.globalVariables||q.globalVariables,p=o.drillStatus||void 0,b=o.pagination||q.pagination,g=o.nativeQuery||q.nativeQuery):(i=q.tempFilters,c=q.linkageFilters,l=q.globalFilters,s=q.orders,u=q.variables,d=q.linkageVariables,f=q.globalVariables,b=q.pagination,g=q.nativeQuery);var x=O.concat(S).filter(function(e){return"\u6307\u6807\u540d\u79f0"!==e.name}).map(function(e){return e.name}),N=w.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}});I&&I.length&&(N=N.concat(I.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),E&&(x=x.concat(E.items.map(function(e){return e.name}))),F&&(x=x.concat(F.items.filter(function(e){return"category"===e.type}).map(function(e){return e.name})),N=N.concat(F.items.filter(function(e){return"value"===e.type}).map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),C&&(N=N.concat(C.items.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),D&&(N=N.concat(D.items.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),A&&(N=N.concat(A.items.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}})));var H=L.reduce(function(e,t){return e.concat(t.config.sqlModel)},[]),V={groups:p&&p.groups?p.groups:x,aggregators:N,filters:p&&p.filter?p.filter.sqls:H,tempFilters:i,linkageFilters:c,globalFilters:l,variables:u,linkageVariables:d,globalVariables:f,orders:j,cache:k,expired:_,flush:"flush"===t,pagination:b,nativeQuery:g,customOrders:P};s&&(V.orders=V.orders.concat(s)),e(t,n,h.dataToken,V)}),ir(ar(r),"onWindowResize",function(){r.resizeSign&&clearTimeout(r.resizeSign),r.resizeSign=window.setTimeout(function(){r.props.onResizeAllDashboardItem(),clearTimeout(r.resizeSign),r.resizeSign=0},500)}),ir(ar(r),"visibleFullScreen",function(e){var t=r.state.allowFullScreen;e&&r.setState({currentDataInFullScreen:e}),r.setState({allowFullScreen:!t})}),ir(ar(r),"currentWidgetInFullScreen",function(e){var t=r.props,n=t.currentItems,a=t.currentItemsInfo,o=t.widgets,i=n.find(function(t){return t.id===e}),c=o.find(function(e){return e.id===i.widgetId}),l=a[e],s=a.loading;r.setState({currentDataInFullScreen:{itemId:e,widgetId:c.id,widget:c,data:l,loading:s,onGetChartData:r.getChartData}})}),ir(ar(r),"handleLegitimateUser",function(){var e=r.state,t=e.type,n=e.shareInfo;r.setState({showLogin:!1},function(){r.loadShareContent({type:t,shareInfo:n})})}),ir(ar(r),"checkInteract",function(e){return r.props.linkages.some(function(t){return+t.trigger[0]===e})}),ir(ar(r),"doInteract",function(e,t){var n=r.props,a=n.currentItems,o=n.linkages,i=Object(It.a)(e,o);r.interactingLinkagers=Object(It.b)(e,t,i,r.interactingLinkagers),Object.keys(i).forEach(function(e){var t=a.find(function(t){return t.id===+e}),n=r.interactingLinkagers[e],o=n.filters,i=n.variables;r.getChartData("rerender",+e,t.widgetId,{linkageFilters:Object.values(o).reduce(function(e,t){return e.concat.apply(e,$t(t))},[]),linkageVariables:Object.values(i).reduce(function(e,t){return e.concat.apply(e,$t(t))},[])})}),r.setState({interactingStatus:er({},r.state.interactingStatus,ir({},e,!0))})}),ir(ar(r),"turnOffInteract",function(e){var t=r.props,n=t.linkages,a=t.currentItems;Object(It.c)(e,n,r.interactingLinkagers).forEach(function(e){var t=a.find(function(t){return t.id===e}),n=r.interactingLinkagers[e],o=n.filters,i=n.variables;r.getChartData("rerender",e,t.widgetId,{linkageFilters:Object.values(o).reduce(function(e,t){return e.concat.apply(e,$t(t))},[]),linkageVariables:Object.values(i).reduce(function(e,t){return e.concat.apply(e,$t(t))},[])})}),r.setState({interactingStatus:er({},r.state.interactingStatus,ir({},e,!1))},function(){var t=a.find(function(t){return t.id===e});r.getChartData("clear",e,t.widgetId)})}),ir(ar(r),"getOptions",function(e,t,n,a){t?r.props.onSetSelectOptions(e,n,a):r.props.onLoadSelectOptions(e,r.state.shareInfo,n,a)}),ir(ar(r),"globalControlChange",function(e){r.props.onGlobalControlChange(e)}),ir(ar(r),"globalControlSearch",function(e){var t=r.props,n=t.currentItems,a=t.widgets,o=t.currentItemsInfo;e.forEach(function(e){var t=n.find(function(t){return t.id===e});if(t){var i=a.find(function(e){return e.id===t.widgetId}),c=o[e].queryConditions.pagination,l=!1;try{var s=JSON.parse(i.config),u=s.mode,d=s.selectedChart,f=s.chartStyles;"chart"===u&&d===Object(Pt.w)().id&&f.table.withPaging&&(c=er({pageSize:Number(f.table.pageSize)},c,{pageNo:qt.u}),l=f.table.withNoAggregators)}catch(e){$.a.error(e)}r.getChartData("rerender",e,t.widgetId,{pagination:c,nativeQuery:l})}})}),ir(ar(r),"globalFilterChange",function(e){var t=r.props,n=t.currentItems,a=t.currentItemsInfo;Object.entries(e).forEach(function(e){var t=tr(e,2),o=t[0],i=t[1],c=n.find(function(e){return e.id===+o});if(c){var l=0,s=a[o].queryConditions.pagination;s.pageNo&&(l=1);var u=i.variables,d=i.filters;r.getChartData("rerender",+o,c.widgetId,{globalVariables:u,globalFilters:d,pagination:er({},s,{pageNo:l})})}})}),ir(ar(r),"dataDrill",function(e){var t=r.props,n=t.widgets,a=t.currentItemsInfo,o=t.onDrillDashboardItem,i=e.itemId,c=e.groups,l=e.widgetId,s=e.sourceDataFilter,u=e.mode,d=e.col,f=e.row,p=n.find(function(e){return e.id===l}),b=JSON.parse(p.config),g=b.cols,m=b.rows,y=b.metrics,h=(b.filters,b.color),v=b.label,O=(b.size,b.xAxis,b.tip,b.orders,b.cache,b.expired,b.model),S=a[i].queryConditions.drillHistory,w=void 0,I=void 0,L=void 0,E=g.concat(m).filter(function(e){return"\u6307\u6807\u540d\u79f0"!==e.name}).map(function(e){return e.name}),F=y.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}});h&&(E=E.concat(h.items.map(function(e){return e.name}))),v&&(E=E.concat(v.items.filter(function(e){return"category"===e.type}).map(function(e){return e.name})),F=F.concat(v.items.filter(function(e){return"value"===e.type}).map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}})));var C=void 0,D=[],A=[],j=[],k=[];if(b.filters.forEach(function(e){k=k.concat(e.config.sqlModel)}),S&&0!==S.length){var _=S[S.length-1],T=void 0,R=void 0;if("chart"===u&&b.selectedChart===Ct.a.Table){var P=s.reduce(function(e,t){return void 0===e[t.key]?e[t.key]=[t.value]:e[t.key].push(t.value),e},{});for(var q in P)void 0!==P[q]&&q&&function(){var e=O[q]&&O[q].sqlType?O[q].sqlType:"VARCHAR",t={name:q,operator:"in",type:"filter",value:P[q].map(function(t){return Object(Te.l)(t,e)}),sqlType:e};j.push(t)}();if(Array.isArray(j)&&j.length>0&&(k=k.concat(j)),_&&_.col&&_.col.length){var x=s[s.length-1].key,N=_.col.reduce(function(e,t){return e.push(t),t.name===x&&e.push({name:c}),e},[]);T=c&&c.length?N:_.col}}else{I=_.groups[_.groups.length-1],L=s.map(function(e){return e[I]});var H=O[I]&&O[I].sqlType?O[I].sqlType:"VARCHAR";w={name:I,operator:"in",type:"filter",value:L.map(function(e){return Object(Te.l)(e,H)}),sqlType:H},k=_.filter.sqls.concat(w),T=d&&d.length?(_.col||[]).concat({name:d}):_.col,R=f&&f.length?(_.row||[]).concat({name:f}):_.row}var V=_.groups.some(function(e){return e===c}),U=void 0;U=V?_.groups.filter(function(e){return e!==c}):"pivot"===u?_.groups.concat([c]):"chart"===u&&b.selectedChart===Ct.a.Table?_.groups.concat([c]):[c],C={filter:{filterSource:L,name:I,sql:w,sqls:k,visualType:"string"},col:T,row:R,type:V?"up":"down",groups:U,name:c}}else{var W=void 0;if(b){var M=b.dimetionAxis;D=b.rows&&b.rows.length?b.rows:[],A=b.cols&&b.cols.length?b.cols:[];var z=b.mode;if(z&&"pivot"===z)if(g&&0!==g.length){var Y=b.cols;I=Y[Y.length-1].name}else{var B=b.rows;I=B[B.length-1].name}else if("col"===M){var G=b.cols;I=G[G.length-1].name}else if("row"===M){var J=b.rows;I=J[J.length-1].name}else if("chart"===z&&b.selectedChart===Ct.a.Table){var Q=s.reduce(function(e,t){return void 0===e[t.key]?e[t.key]=[t.value]:e[t.key].push(t.value),e},{});for(var K in Q)void 0!==Q[K]&&K&&function(){var e=O[K]&&O[K].sqlType?O[K].sqlType:"VARCHAR",t={name:K,operator:"in",type:"filter",value:Q[K].map(function(t){return Object(Te.l)(t,e)}),sqlType:e};j.push(t)}();var Z=s[s.length-1].key,X=A.reduce(function(e,t){return e.push(t),t.name===Z&&e.push({name:c}),e},[]);W=c&&c.length?X:void 0}}if(L=s.map(function(e){if(e&&e[I])return e[I]}),I&&I.length){W=d&&d.length?A.concat([{name:d}]):void 0;var $=O[I]&&O[I].sqlType?O[I].sqlType:"VARCHAR";w={name:I,operator:"in",type:"filter",value:L.map(function(e){return Object(Te.l)(e,$)}),sqlType:$},k.push(w)}Array.isArray(j)&&j.length>0&&(k=k.concat(j));var ee=E.some(function(e){return e===c}),te=void 0;te=ee?E.filter(function(e){return e!==c}):"pivot"===u?E.concat([c]):"chart"===u&&b.selectedChart===Ct.a.Table?E.concat([c]):[c],C={filter:{filterSource:L,name:I,sql:w,sqls:k,visualType:"string"},type:ee?"up":"down",col:W,row:f&&f.length?D.concat([{name:f}]):void 0,groups:te,name:c}}o(i,C),r.getChartData("rerender",i,l,{drillStatus:C})}),ir(ar(r),"selectDrillHistory",function(e,t,n,a){var o=r.props,i=(o.currentItemsInfo,o.onDeleteDrillHistory);e?r.getChartData("rerender",n,a,{drillStatus:e}):r.getChartData("rerender",n,a),i(n,t)}),ir(ar(r),"selectChartsItems",function(e,t,n){(0,r.props.onSelectDashboardItemChart)(e,t,n)}),ir(ar(r),"loadDownloadList",function(){r.props.onLoadDownloadList(r.shareClientId,r.state.shareInfo)}),ir(ar(r),"downloadFile",function(e){r.props.onDownloadFile(e,r.shareClientId,r.state.shareInfo)}),r.state={type:"",shareInfo:"",views:{},modalLoading:!1,interactingStatus:{},allowFullScreen:!1,currentDataInFullScreen:{},showLogin:!1,headlessBrowserRenderSign:!1,controlTokenMapping:{}},r}var r,n,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&or(e,t)}(t,i.a.Component),r=t,(n=[{key:"componentWillMount",value:function(){var e=this.querystring(location.href.substr(location.href.indexOf("?")+1));this.setState({type:e.type,shareInfo:e.shareInfo}),this.loadShareContent(e),this.initPolling(e.shareInfo),delete e.type,delete e.shareInfo,this.props.onSendShareParams(e)}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onWindowResize,!1)}},{key:"componentWillReceiveProps",value:function(e){var t=this,r=e.currentItems,n=e.currentItemsInfo,a=(e.dashboard,e.widgets);if(a&&a!==this.props.widgets)try{this.setState({views:a.reduce(function(e,t){return er({},e,ir({},t.id,{model:JSON.parse(t.model)}))},{})})}catch(e){$.a.error(e)}n&&(Object.values(n).filter(function(e){return[cr.Fulfilled,cr.Error].includes(e.status)}).length===r.length&&setTimeout(function(){t.setState({headlessBrowserRenderSign:!0})},5e3))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize,!1),this.downloadListPollingTimer&&clearInterval(this.downloadListPollingTimer)}},{key:"deep_set",value:function(e,t,r){for(var n=0;n<t.length-1;n++)void 0===e[t[n]]&&(e[t[n]]=t[n+1].match(/^\d+$/)?[]:{}),e=e[t[n]];e[t[n]]=decodeURIComponent(r)}},{key:"render",value:function(){var e,t=this,r=this.props,n=r.dashboard,a=r.title,o=r.currentItems,c=r.currentItemsInfo,l=r.widgets,s=r.linkages,u=r.dashboardSelectOptions,d=r.downloadList,f=this.state,b=(f.shareInfo,f.showLogin),g=f.views,m=f.interactingStatus,y=f.allowFullScreen,h=f.headlessBrowserRenderSign,v=null,O=null;if(o){var S=[],w={lg:[]};o.forEach(function(e){var r=e.id,n=e.x,a=e.y,o=e.width,u=e.height,d=e.widgetId,f=e.polling,p=e.frequency,b=c[r],y=b.datasource,h=b.loading,v=b.downloadCsvLoading,O=b.renderType,I=b.queryConditions,L=b.controlSelectOptions,E=b.selectedItems,F=b.errorMessage,C=l.find(function(e){return e.id===d}),D=g[d],A=m[r]||!1,j=I.drillHistory,k=!(!s||!s.length)&&s.map(function(e){return e.trigger[0]}).some(function(e){return e===String(r)});S.push(i.a.createElement("div",{key:r},i.a.createElement(Lt.a,{itemId:r,widget:C,widgets:l,view:D,isTrigger:k,datasource:y,loading:h,polling:f,onDrillData:t.dataDrill,onSelectDrillHistory:t.selectDrillHistory,interacting:A,drillHistory:j,frequency:p,shareInfo:C.dataToken,downloadCsvLoading:v,renderType:O,controlSelectOptions:L,queryConditions:I,errorMessage:F,onGetChartData:t.getChartData,onDownloadCsv:t.initiateWidgetDownloadTask,onTurnOffInteract:t.turnOffInteract,onCheckTableInteract:t.checkInteract,onDoTableInteract:t.doInteract,onShowFullScreen:t.visibleFullScreen,onGetControlOptions:t.getOptions,container:"share",selectedItems:E||[],onSelectChartsItems:t.selectChartsItems}))),w.lg.push({x:n,y:a,w:o,h:u,i:"".concat(r)})}),v=i.a.createElement(ur,{className:"layout",style:{marginTop:"-16px"},rowHeight:qt.z,margin:[qt.y,qt.y],breakpoints:qt.w,cols:qt.x,layouts:w,measureBeforeMount:!1,useCSSTransforms:!1,isDraggable:!1,isResizable:!1},S),O=i.a.createElement(Et.a,{widgets:l,currentItems:o,currentDashboard:{widgets:o},currentItemsInfo:c,visible:y,isVisible:this.visibleFullScreen,currentDataInFullScreen:this.state.currentDataInFullScreen,onCurrentWidgetInFullScreen:this.currentWidgetInFullScreen})}else v=i.a.createElement("div",{className:sr.shareContentEmpty},dr),O="";e=b?i.a.createElement(Zt,{shareInfo:this.state.shareInfo,legitimateUser:this.handleLegitimateUser}):"";var I=document.getElementById("app");return i.a.createElement(wt.a,null,i.a.createElement(p.a,{title:a}),i.a.createElement(wt.a.Title,null,i.a.createElement(Q.a,null,i.a.createElement(Z.a,{span:24},i.a.createElement("h2",{className:sr.shareTitle},a),i.a.createElement("div",{className:sr.shareDownloadListToggle},i.a.createElement(At.a,{downloadList:d,onLoadDownloadList:this.loadDownloadList,onDownloadFile:this.downloadFile})))),i.a.createElement(Dt.a,{currentDashboard:n,currentItems:o,onGetOptions:this.getOptions,mapOptions:u,onChange:this.globalControlChange,onSearch:this.globalControlSearch})),v,i.a.createElement("div",{className:sr.gridBottom}),O,e,i.a.createElement(_t,{renderSign:h,parentNode:I}))}}])&&rr(r.prototype,n),a&&rr(r,a),t}(),pr=Object(ee.b)({dashboard:Object(ee.a)(Rt,function(e){return e.get("dashboard")}),title:Object(ee.a)(Rt,function(e){return e.get("title")}),config:Object(ee.a)(Rt,function(e){return e.get("config")}),widgets:Object(ee.a)(Rt,function(e){return e.get("widgets")}),currentItems:Object(ee.a)(Rt,function(e){return e.get("items")}),currentItemsInfo:Object(ee.a)(Rt,function(e){return e.get("itemsInfo")}),dashboardSelectOptions:Object(ee.a)(Rt,function(e){return e.get("dashboardSelectOptions")}),linkages:Object(ee.a)(Rt,function(e){var t=e.get("config");if(!t)return[];var r=JSON.parse(t||{}).linkages;if(!r)return[];var n=e.get("itemsInfo");return r.filter(function(e){var t=e.linkager,r=e.trigger;return n[t[0]]&&n[r[0]]})}),downloadList:Object(ee.a)(Rt,function(e){return e.get("downloadList")}),shareParams:Object(ee.a)(Rt,function(e){return e.get("shareParams")})});var br,gr=Object(l.connect)(pr,function(e){return{onLoadViewsDetail:function(t,r){return e(lr(t,r))},onLoadDashboard:function(t,r){return e(function(e,t){return{type:te,payload:{token:e,reject:t}}}(t,r))},onLoadWidget:function(t,r,n){return e(function(e,t,r){return{type:oe,payload:{token:e,resolve:t,reject:r}}}(t,r,n))},onLoadResultset:function(t,r,n,a){return e(function(e,t,r,n){return{type:ce,payload:{renderType:e,itemId:t,dataToken:r,requestParams:n}}}(t,r,n,a))},onSetIndividualDashboard:function(t,r){return e(function(e,t){return{type:ae,payload:{widgetId:e,token:t}}}(t,r))},onLoadWidgetCsv:function(t,r,n){return e(function(e,t,r){return{type:ue,payload:{itemId:e,requestParams:t,token:r}}}(t,r,n))},onLoadSelectOptions:function(t,r,n,a){return e(function(e,t,r,n){return{type:pe,payload:{controlKey:e,dataToken:t,requestParams:r,itemId:n}}}(t,r,n,a))},onSetSelectOptions:function(t,r,n){return e(function(e,t,r){return{type:ve,payload:{controlKey:e,options:t,itemId:r}}}(t,r,n))},onResizeAllDashboardItem:function(){return e({type:me})},onDrillDashboardItem:function(t,r){return e(function(e,t){return{type:ye,payload:{itemId:e,drillHistory:t}}}(t,r))},onDeleteDrillHistory:function(t,r){return e(function(e,t){return{type:he,payload:{itemId:e,index:t}}}(t,r))},onSelectDashboardItemChart:function(t,r,n){return e(function(e,t,r){return{type:Oe,payload:{itemId:e,renderType:t,selectedItems:r}}}(t,r,n))},onGlobalControlChange:function(t){return e(function(e){return{type:Se,payload:{controlRequestParamsByItem:e}}}(t))},onInitiateDownloadTask:function(t,r,n,a){return e(function(e,t,r,n,a){return{type:Ae,payload:{shareClientId:e,dataToken:t,type:r,downloadParams:n,itemId:a}}}(t,r,n,a))},onLoadDownloadList:function(t,r){return e(function(e,t){return{type:Ie,payload:{shareClinetId:e,token:t}}}(t,r))},onDownloadFile:function(t,r,n){return e(function(e,t,r){return{type:Fe,payload:{id:e,shareClinetId:t,token:r}}}(t,r,n))},onSendShareParams:function(t){return e(function(e){return{type:we,payload:{params:e}}}(t))}}}),mr=Object(g.a)({key:"shareDashboard",reducer:Ue}),yr=Object(m.a)({key:"shareDashboard",saga:St}),hr=Object(b.compose)(mr,yr,gr)(fr),vr=r("fdb445ec61a8d515506e");!function(e){e.LOAD_SHARE_DISPLAY="dq/Share/LOAD_SHARE_DISPLAY",e.LOAD_SHARE_DISPLAY_SUCCESS="dq/Share/LOAD_SHARE_DISPLAY_SUCCESS",e.LOAD_SHARE_DISPLAY_FAILURE="dq/Share/LOAD_SHARE_DISPLAY_FAILURE",e.LOAD_LAYER_DATA="dq/Share/LOAD_LAYER_DATA",e.LOAD_LAYER_DATA_SUCCESS="dq/Share/LOAD_LAYER_DATA_SUCCESS",e.LOAD_LAYER_DATA_FAILURE="dq/Share/LOAD_LAYER_DATA_FAILURE"}(br||(br={}));var Or=Object(vr.a)(br),Sr=r("af45b63fe9fc857a79a4");function wr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){Ir(e,t,r[t])})}return e}function Ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Lr=Object(O.fromJS)({title:"",display:null,slide:null,layers:[],layersInfo:{},widgets:[]});var Er=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lr,t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload,a=e.get("layersInfo");switch(r){case Or.LOAD_SHARE_DISPLAY_SUCCESS:return e.set("title",n.display.name).set("display",n.display).set("slide",n.slide).set("layers",n.slide.relations).set("widgets",n.widgets).set("layersInfo",n.slide.relations.reduce(function(e,t){return e[t.id]=t.type===Sr.a.Chart?{status:cr.Initial,datasource:{resultList:[]},loading:!1,queryConditions:{tempFilters:[],linkageFilters:[],globalFilters:[],variables:[],linkageVariables:[],globalVariables:[]},interactId:"",renderType:"rerender"}:{loading:!1},e},{}));case Or.LOAD_SHARE_DISPLAY_FAILURE:return e.set("display",null).set("slide",null).set("layers",[]).set("widgets",[]).set("layersInfo",{});case Or.LOAD_LAYER_DATA:return e.set("layersInfo",wr({},a,Ir({},n.layerId,wr({},a[n.layerId],{loading:!0}))));case Or.LOAD_LAYER_DATA_SUCCESS:return Object(qe.c)(n.data.resultList,n.requestParams.customOrders),e.set("layersInfo",wr({},a,Ir({},n.layerId,wr({},a[n.layerId],{status:cr.Fulfilled,loading:!1,datasource:n.data,renderType:n.renderType}))));case Or.LOAD_LAYER_DATA_FAILURE:return e.set("loadings",wr({},a,Ir({},n.layerId,wr({},a[n.layerId],{status:cr.Error,loading:!1}))));default:return e}},Fr={loadDisplay:function(e,t,r){return{type:Or.LOAD_SHARE_DISPLAY,payload:{token:e,resolve:t,reject:r}}},displayLoaded:function(e,t,r){return{type:Or.LOAD_SHARE_DISPLAY_SUCCESS,payload:{display:e,slide:t,widgets:r}}},loadDisplayFail:function(e){return{type:Or.LOAD_SHARE_DISPLAY_FAILURE,payload:{error:e}}},loadLayerData:function(e,t,r,n){return{type:Or.LOAD_LAYER_DATA,payload:{renderType:e,layerId:t,dataToken:r,requestParams:n}}},layerDataLoaded:function(e,t,r,n){return{type:Or.LOAD_LAYER_DATA_SUCCESS,payload:{renderType:e,layerId:t,data:r,requestParams:n}}},loadLayerDataFail:function(e){return{type:Or.LOAD_LAYER_DATA_FAILURE,payload:{error:e}}}},Cr=(Object(vr.b)(Fr),Fr);function Dr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){Ar(e,t,r[t])})}return e}function Ar(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jr(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var kr=regeneratorRuntime.mark(Rr),_r=regeneratorRuntime.mark(Pr),Tr=regeneratorRuntime.mark(qr);function Rr(e){var t,r,n,a,o,i,c,l,s,u,d,f;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(e.type===Or.LOAD_SHARE_DISPLAY){p.next=2;break}return p.abrupt("return");case 2:return t=e.payload,r=t.token,n=t.resolve,a=t.reject,o=Cr.loadDisplayFail,i=Cr.displayLoaded,p.prev=4,p.next=7,Object(L.b)(E.a,"".concat(C.a.share,"/display/").concat(r));case 7:if(c=p.sent,l=c.header,s=c.payload,401!==l.code){p.next=14;break}return a(l.msg),p.next=13,Object(L.c)(o(l.msg));case 13:return p.abrupt("return");case 14:return d=(u=s).slides,f=u.widgets,p.next=18,Object(L.c)(i(u,d[0],f||[]));case 18:n(u,d[0],f),p.next=28;break;case 21:return p.prev=21,p.t0=p.catch(4),$.a.destroy(),p.next=26,Object(L.c)(o(p.t0));case 26:$.a.error("\u83b7\u53d6 Display \u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5"),a(p.t0);case 28:case"end":return p.stop()}},kr,null,[[4,21]])}function Pr(e){var t,r,n,a,o,i,c,l,s,u,d,f,p,b,g,m,y,h,v,O,S;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(e.type===Or.LOAD_LAYER_DATA){w.next=2;break}return w.abrupt("return");case 2:return t=e.payload,r=t.renderType,n=t.layerId,a=t.dataToken,o=t.requestParams,i=o.filters,c=o.tempFilters,l=o.linkageFilters,s=o.globalFilters,u=o.variables,d=o.linkageVariables,f=o.globalVariables,p=o.pagination,b=jr(o,["filters","tempFilters","linkageFilters","globalFilters","variables","linkageVariables","globalVariables","pagination"]),m=(g=p||{pageSize:0,pageNo:0}).pageSize,y=g.pageNo,h=Cr.layerDataLoaded,v=Cr.loadLayerDataFail,w.prev=6,w.next=9,Object(L.b)(E.a,{method:"post",url:"".concat(C.a.share,"/data/").concat(a),data:Dr({},Me()(b,"customOrders"),{filters:i.concat(c).concat(l).concat(s),params:u.concat(d).concat(f),pageSize:m,pageNo:y})});case 9:return O=w.sent,S=O.payload.resultList,O.payload.resultList=S&&S.slice(0,600)||[],w.next=14,Object(L.c)(h(r,n,O.payload,o));case 14:w.next=20;break;case 16:return w.prev=16,w.t0=w.catch(6),w.next=20,Object(L.c)(v(w.t0));case 20:case"end":return w.stop()}},_r,null,[[6,16]])}function qr(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[Object(I.c)(Or.LOAD_SHARE_DISPLAY,Rr),Object(I.b)(Or.LOAD_LAYER_DATA,Pr)];case 2:case"end":return e.stop()}},Tr)}var xr=r("f10f809a0f3792f3a22d"),Nr=function(e){return e.get("shareDisplay")};function Hr(e){return(Hr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ur(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wr(e){return(Wr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zr(e,t){return(zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Br=r("6a7fad1b7c06479779b2"),Gr=r("26317c735995b6f84276"),Jr=Cr.loadDisplay,Qr=Cr.loadLayerData,Kr=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=Wr(t).call(this,e),r=!a||"object"!==Hr(a)&&"function"!==typeof a?Mr(n):a,Yr(Mr(r),"charts",{}),Yr(Mr(r),"displayCanvas",Object(o.createRef)()),Yr(Mr(r),"getChartData",function(e,t,n,a){var o,i,c,l,s,u,d,f,p,b=r.props,g=b.widgets,m=b.layersInfo,y=b.onLoadLayerData,h=g.find(function(e){return e.id===n}),v=JSON.parse(h.config),O=v.cols,S=v.rows,w=v.metrics,I=v.secondaryMetrics,L=v.filters,E=v.color,F=v.label,C=v.size,D=v.xAxis,A=v.tip,j=v.orders,k=v.cache,_=v.expired,T=O.map(function(e){return Object(Re.d)(e)}),R=S.map(function(e){return Object(Re.d)(e)}),P=T.concat(R).filter(function(e){var t=e.sort;return t&&t.sortType===qe.a.Custom}).map(function(e){return{name:e.name,list:e.sort[qe.a.Custom].sortList}}),q=m[t].queryConditions;a?(o=void 0!==a.tempFilters?a.tempFilters:q.tempFilters,i=void 0!==a.linkageFilters?a.linkageFilters:q.linkageFilters,c=void 0!==a.globalFilters?a.globalFilters:q.globalFilters,l=void 0!==a.orders?a.orders:q.orders,s=a.variables||q.variables,u=a.linkageVariables||q.linkageVariables,d=a.globalVariables||q.globalVariables,f=a.pagination||q.pagination,p=a.nativeQuery||q.nativeQuery):(o=q.tempFilters,i=q.linkageFilters,c=q.globalFilters,l=q.orders,s=q.variables,u=q.linkageVariables,d=q.globalVariables,f=q.pagination,p=q.nativeQuery);var x=O.concat(S).filter(function(e){return"\u6307\u6807\u540d\u79f0"!==e.name}).map(function(e){return e.name}),N=w.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}});I&&I.length&&(N=N.concat(I.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),E&&(x=x.concat(E.items.map(function(e){return e.name}))),F&&(x=x.concat(F.items.filter(function(e){return"category"===e.type}).map(function(e){return e.name})),N=N.concat(F.items.filter(function(e){return"value"===e.type}).map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),C&&(N=N.concat(C.items.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),D&&(N=N.concat(D.items.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}}))),A&&(N=N.concat(A.items.map(function(e){return{column:Object(Pt.b)(e.name),func:e.agg}})));var H={groups:x,aggregators:N,filters:L.reduce(function(e,t){return e.concat(t.config.sqlModel)},[]),tempFilters:o,linkageFilters:i,globalFilters:c,variables:s,linkageVariables:u,globalVariables:d,orders:j,cache:k,expired:_,flush:"flush"===e,pagination:f,nativeQuery:p,customOrders:P};l&&(H.orders=H.orders.concat(l)),y(e,t,h.dataToken,H)}),Yr(Mr(r),"getPreviewStyle",function(e){var t={};switch(e.scaleMode){case"scaleWidth":t.overflowY="auto";break;case"scaleHeight":t.overflowX="auto";break;case"noScale":t.overflow="auto"}return t}),Yr(Mr(r),"getSlideStyle",function(e,t){var r,n=e.width,a=e.height,o=e.scaleMode,i=e.backgroundColor,c=e.backgroundImage,l=document.body,s=l.clientWidth,u=l.clientHeight,d=Vr(t,2),f=d[0],p=d[1],b=(f-1)/2,g=(p-1)/2;b+=Math.max(0,(s-f*n)/(2*n)),g+=Math.max(0,(u-p*a)/(2*a));var m="translate(".concat(100*b,"%, ").concat(100*g,"%)"),y=r={overflow:"visible",width:n,height:a,transform:"".concat(m," scale(").concat(f,", ").concat(p,")")};if("scaleWidth"===o&&screen.width<=1024&&(y=document.body.style),y.backgroundSize="cover",i){var h=i.join();y.backgroundColor="rgba(".concat(h,")")}return c&&(y.backgroundImage='url("'.concat(c,'")')),r}),Yr(Mr(r),"loadShareContent",function(){(0,r.props.onLoadDisplay)(r.state.shareInfo,function(){console.log("share page need login...")},function(){r.setState({showLogin:!0})})}),Yr(Mr(r),"handleLegitimateUser",function(){r.setState({showLogin:!1},function(){r.loadShareContent()})}),r.state={scale:[1,1],showLogin:!1,shareInfo:"",headlessBrowserRenderSign:!1},r}var r,n,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zr(e,t)}(t,i.a.Component),r=t,(n=[{key:"componentWillMount",value:function(){var e=this,t=this.props.location.query.shareInfo;this.setState({shareInfo:t},function(){e.loadShareContent()})}},{key:"componentWillReceiveProps",value:function(e){var t=this,r=e.slide,n=e.layers,a=e.layersInfo,o=Vr(this.state.scale,2),i=o[0],c=o[1];if(r&&this.props.slide!==r){var l=JSON.parse(r.config).slideParams,s=l.scaleMode,u=l.width,d=l.height,f=document.body,p=f.clientHeight,b=f.clientWidth,g=1,m=1;switch(s){case"scaleHeight":m=g=p/d;break;case"scaleWidth":g=m=b/u;break;case"scaleFull":g=p/d,m=b/u}c===g&&i===m||this.setState({scale:[m,g]})}if(a){var y=n.filter(function(e){return e.type===Sr.a.Chart});Object.entries(a).filter(function(e){var t=Vr(e,2),r=t[0],n=t[1];return y.find(function(e){return e.id===Number(r)})&&[cr.Fulfilled,cr.Error].includes(n.status)}).length===y.length&&setTimeout(function(){t.setState({headlessBrowserRenderSign:!0})},5e3)}}},{key:"render",value:function(){var e=this,t=this.props,r=t.title,n=t.widgets,a=t.display,o=t.slide,c=t.layers,l=t.layersInfo,s=this.state,u=(s.scale,s.showLogin),d=s.shareInfo,f=s.headlessBrowserRenderSign,b=u?i.a.createElement(Zt,{shareInfo:d,legitimateUser:this.handleLegitimateUser}):null,g=null,m=null;if(a){var y=this.state.scale,h=JSON.parse(o.config).slideParams;m=this.getPreviewStyle(h);var v=this.getSlideStyle(h,y),O=Array.isArray(n)?c.map(function(t){var r=n.find(function(e){return e.id===t.widgetId}),a=r&&JSON.parse(r.model),o=t.id,c=JSON.parse(t.params),s=c.polling,u=c.frequency,d=l[o],f=d.datasource,p=d.loading,b=d.interactId,g=d.renderType;return i.a.createElement(xr.a,{key:t.id,pure:!0,itemId:o,widget:r,model:a,datasource:f,layer:t,loading:p,polling:s,frequency:u,interactId:b,renderType:g,onGetChartData:e.getChartData})}):null;g=i.a.createElement("div",{className:Gr.board,style:v,ref:this.displayCanvas},O)}return i.a.createElement("div",{className:Br.container},i.a.createElement("div",{className:Gr.preview,style:m},i.a.createElement(p.a,{title:r}),g,b),i.a.createElement(_t,{renderSign:f,parentNode:this.displayCanvas.current}))}}])&&Ur(r.prototype,n),a&&Ur(r,a),t}(),Zr=Object(ee.b)({title:Object(ee.a)(Nr,function(e){return e.get("title")}),display:Object(ee.a)(Nr,function(e){return e.get("display")}),slide:Object(ee.a)(Nr,function(e){return e.get("slide")}),layers:Object(ee.a)(Nr,function(e){return e.get("layers")}),widgets:Object(ee.a)(Nr,function(e){return e.get("widgets")}),layersInfo:Object(ee.a)(Nr,function(e){return e.get("layersInfo")})});var Xr=Object(l.connect)(Zr,function(e){return{onLoadDisplay:function(t,r,n){return e(Jr(t,r,n))},onLoadLayerData:function(t,r,n,a){return e(Qr(t,r,n,a))}}}),$r=Object(g.a)({key:"shareDisplay",reducer:Er}),en=Object(m.a)({key:"shareDisplay",saga:qr}),tn=Object(b.compose)($r,en,Xr)(Kr),rn=function(e){console.error("Dynamic page loading failed",e)},nn=function(e){return function(t){e(null,t.default)}};r("ed0aa665d8cc7f062de1"),r("1dad865dd74034286d56"),r("3670a75cdf40147fed09"),r("360199e61df61d70683e"),r("8a7df9b2a2fe5d99ea98"),r("c302bbd821e068aec7ca"),r("488186eb3b2e0c1c414a"),r("40f52d283acb8661d97f"),r("1a8a0d02691ba2237e1c");var an=r("c4f39450f01ceef3e1a4");r("9c18a49d5131280d62e2"),r("df7d0ca888dfc4ab84c0"),r("c75488ff72785c93e091"),r("9522c301b87f3097acdb"),r("c051faebbdca1b75abc0"),r("e7db2ab4d56937661155"),r("6350ba3c445cdf809f5d"),r("6d75da2315198816512d"),r("2e326f71ba041e9e5483"),r("92d8b6d49c08574abb86"),r("32ed649d5a98409f05d0"),r("593fb6ed96492637817d"),r("0c83eda191a155223e4f"),r("70ed4cbab24ae23bde7d"),r("38209c7bc1e9aed95306"),r("9132142da73ea939e5d6"),r("ba53a5f89c617e663ad1"),r("8835a003a3ed67b22811"),r("8c6d270aa08c18b72e43"),r("0a240ff6093590e2060b"),r("61d2dc633a96c99ada22"),r("ed842d3aa93065270196"),r("4b78455cac8a29b25e34"),r("7e08bdc8c06aba9df8ea"),r("58a6adeccb3334926a24"),r("cf137f88cec7945b84a3"),r("d3c16768a7bfb407293b"),r("ec2bbc87777bad684f91");H.default.locale("zh-cn"),an.registerTheme("default",qt.o);var on=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=[B,Object(u.routerMiddleware)(t)],n=b.compose,a=Object(b.createStore)(Y(),Object(O.fromJS)(e),n(b.applyMiddleware.apply(void 0,r)));return a.runSaga=B.run,a.injectedReducers={},a.injectedSagas={},a}({},s.d),cn=document.getElementById("app"),ln=Object(u.syncHistoryWithStore)(s.d,on,{selectLocationState:Object(P.b)()}),sn={path:"/",component:R,childRoutes:[{path:"/share/dashboard",component:hr},{path:"/share/display",component:tn},{path:"*",name:"notfound",getComponent:function(e,t){r.e(2).then(r.bind(null,"8937ca26cad1b574ef33")).then(nn(t)).catch(rn)}}],indexRoute:{onEnter:function(e,t){t("/share")}}},un=function(e){c.render(o.createElement(l.Provider,{store:on},o.createElement(q.a,{messages:e},o.createElement(a.a,{locale:N.a},o.createElement(s.b,{history:ln,routes:sn,render:Object(s.c)(Object(d.useScroll)())})))),cn)};window.Intl?un(G.b):new Promise(function(e){e(Promise.all([r.e(0),r.e(3)]).then(r.t.bind(null,"97694e21b72f8e9351c4",7)))}).then(function(){return Promise.all([r.e(0).then(r.t.bind(null,"f030ad8f70186ef5cb63",7))])}).then(function(){return un(G.b)}).catch(function(e){throw e}),window.__REACT_DEVTOOLS_GLOBAL_HOOK__&&(window.__REACT_DEVTOOLS_GLOBAL_HOOK__.inject=function(){})}},[[2,6,0,1]]]);